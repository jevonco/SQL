

/*What percentage of the Netflix catalog is movies?*/

SELECT
ROUND
(CAST
((SELECT COUNT(*)
FROM "CharlotteChaze/BreakIntoTech"."netflix_titles_info"
WHERE type ILIKE 'movie') AS NUMERIC)
/
(SELECT COUNT(*) 
FROM "CharlotteChaze/BreakIntoTech"."netflix_titles_info"),2)
AS movies;

/*Who care the top 5 directors with the most titles in the Netflix Catalog?*/

SELECT director, COUNT(title)
FROM "CharlotteChaze/BreakIntoTech"."netflix_people" people
JOIN "CharlotteChaze/BreakIntoTech"."netflix_titles_info" titles
ON people.show_id = titles.show_id
WHERE director IS NOT NULL
GROUP BY director
ORDER BY COUNT(title) DESC;

/*Which directors were behind each title in the United States?*/

SELECT  people.show_id, director, title, type
FROM "CharlotteChaze/BreakIntoTech"."netflix_people" people
JOIN "CharlotteChaze/BreakIntoTech"."netflix_titles_info" titles
ON people.show_id = titles.show_id
WHERE director IS NOT NULL
AND country ILIKE 'United%'
ORDER BY director;

/*Which directors were behind each title in the United States?*/

SELECT  people.show_id, director, title, type
FROM "CharlotteChaze/BreakIntoTech"."netflix_people" people
JOIN "CharlotteChaze/BreakIntoTech"."netflix_titles_info" titles
ON people.show_id = titles.show_id
WHERE director IS NOT NULL
AND country ILIKE 'United%'
ORDER BY director;

/*return the date added and release year next to each other*/

SELECT 
EXTRACT(YEAR FROM date_added),release_year
FROM "CharlotteChaze/BreakIntoTech"."netflix_titles_info"
WHERE date_added > 
(SELECT 
CAST(date_added AS DATE)
FROM "CharlotteChaze/BreakIntoTech"."netflix_titles_info")

SELECT date_added,release_year
FROM "CharlotteChaze/BreakIntoTech"."netflix_titles_info"
WHERE date_added IN 2021-09-23
(SELECT 
CAST(date_added AS DATE)
FROM "CharlotteChaze/BreakIntoTech"."netflix_titles_info");

